var BasicGrid=function(a){this.data=a.data,this.htmlElement=$(a.htmlElement),this.searchBy=a.searchBy,this.itemsPerPage=a.itemsPerPage||10,this.sortBy=a.sortBy,this._init()};BasicGrid.prototype._createTableHTML=function(){function a(){for(c=0,d=e.sortBy.length;d>c;c++)if(e.sortBy[c]===b)return!0;return!1}var b,c,d,e=this,f=this.data[0],g="";g+='<table><tr class="head">';for(b in f)g+=this.sortBy&&a(b)?'<th class="BasicSearch-td-'+b+'"><strong class="BasicGrid-sort-by" data-sort-by="'+b+'"><span class="BasicSearch-sort-arrow"></span>'+b+"</strong>":'<th class="BasicSearch-td-'+b+'"><strong>'+b+"</strong>",b===this.searchBy&&(g+='<form class="BasicGrid-search"><input type="text" value="Search by '+b+'" class="BasicGrid-search-by" /><span class="BasicGrid-search-button"></span></form>'),g+="</th>";g+="</tr></table>",this.htmlElement.html(g)},BasicGrid.prototype._createPaginationHTML=function(){this.htmlElement.append('<div class="BasicGrid-pagination"><a href="#" class="BasicGrid-prev">&laquo;</a><a href="#" class="BasicGrid-next">&raquo;</a></div>')},BasicGrid.prototype._addEvents=function(){var a,b=this,c=b.htmlElement.find(".BasicGrid-search-by"),d={},e=b.htmlElement.find(".BasicGrid-search-button");c.keyup(function(){clearTimeout(a),a=setTimeout(function(){d[b.searchBy]=c.val(),b.filter(d),""!=this.value&&e.addClass("BasicGrid-clear-button")},200)}).focus(function(){this.value==="Search by "+b.searchBy&&(this.value="")}).blur(function(){""===this.value&&(this.value="Search by "+b.searchBy)}),e.click(function(){$(this).hasClass("BasicGrid-clear-button")&&($(this).removeClass("BasicGrid-clear-button"),clearTimeout(a),c.val(""),d[b.searchBy]=c.val(),b.filter(d),c.val("Search by "+b.searchBy))}),b.htmlElement.find(".BasicGrid-sort-by").click(function(){var a=$(this),c=a.attr("data-sort-order");b.htmlElement.find(".BasicGrid-sort-by").attr("data-sort-order",""),b.htmlElement.find(".BasicGrid-sort-by .BasicSearch-sort-arrow").html(""),c&&"desc"!=c?"asc"==c&&(a.attr("data-sort-order","desc"),$(".BasicSearch-sort-arrow",a).html("&#x25BC;"),b.sort(a.attr("data-sort-by"),"desc")):(a.attr("data-sort-order","asc"),$(".BasicSearch-sort-arrow",a).html("&#x25B2;"),b.sort(a.attr("data-sort-by"),"asc"))})},BasicGrid.prototype._setupPagination=function(){var a=this;a._updatePagination(),a._$prev.click(function(){return a._prevPage(),!1}),a._$next.click(function(){return a._nextPage(),!1})},BasicGrid.prototype._updatePagination=function(){var a=this;if(a._pages=Math.ceil(a._items/a.itemsPerPage),a._pages>1){a._$pagination.show(),$(".item",a._$pagination).unbind().remove(),a._$prev.addClass("disabled");for(var b=1;b<=a._pages;b++)$('<a href="#" class="item item'+b+'">'+b+"</a>").insertBefore(a._$next);var c=$(".item",a._$pagination);c.eq(0).addClass("selected"),c.click(function(){return a._goToPage(this.innerHTML),!1}),a._page=1,a._formatPagination()}else a._$pagination.hide(),$(".item",a._$pagination).unbind().remove()},BasicGrid.prototype._goToPage=function(a){var b=this,c=(a-1)*b.itemsPerPage,d=c+b.itemsPerPage;b._populateGrid(c,d),$(".selected",b._$pagination).removeClass("selected"),b.htmlElement.find(".item"+a).addClass("selected"),b._page=a,b._page==b._pages?(b._$prev.removeClass("disabled"),b._$next.addClass("disabled")):b._page>1?(b._$prev.removeClass("disabled"),b._$next.removeClass("disabled")):(b._$prev.addClass("disabled"),b._$next.removeClass("disabled")),b._formatPagination()},BasicGrid.prototype._formatPagination=function(){if(this.htmlElement.find(".BasicGrid-more").remove(),this._pages>10){var a,b=this._$pagination.find(".item"),c=b.last(),d=b.first();if(b.hide(),this._page<5){for(a=0;5>a;a++)b.eq(a).show();c.show(),$('<span class="BasicGrid-more">...</span>').insertBefore(c)}else if(this._page<=this._pages-4){var e=parseInt(this._page)-3,f=parseInt(this._page)+2;for(a=e;f>a;a++)b.eq(a).show();d.show(),$('<span class="BasicGrid-more">...</span>').insertAfter(d),c.show(),$('<span class="BasicGrid-more">...</span>').insertBefore(c)}else{var e=parseInt(this._pages)-5,f=parseInt(this._pages);for(a=e;f>=a;a++)b.eq(a).show();d.show(),$('<span class="BasicGrid-more">...</span>').insertAfter(d)}}else this._$pagination.find(".BasicGrid-hidden-pages-prev, .BasicGrid-hidden-pages-next").hide()},BasicGrid.prototype._prevPage=function(){var a=this;a._page>1&&(a._page--,a._goToPage(a._page))},BasicGrid.prototype._nextPage=function(){var a=this;a._page<a._pages&&(a._page++,a._goToPage(a._page))},BasicGrid.prototype._addRow=function(a,b){var b,c=this,d="";if(a===!1)d='<tr><td style="text-align: center" colspan="'+c.htmlElement.find("th").length+'">No results found</td></tr>';else{d+="<tr>";for(b in a)d+="<td>"+a[b]+"</td>";d+="</tr>"}c._$grid.append(d)},BasicGrid.prototype._populateGrid=function(a,b){var c,d=this,e=d._items,f=0;if(a&&b)f=a,c=e>=b?b:e;else{var g=f+d.itemsPerPage;c=e>=g?g:e}if($("tr",d._$grid).not(".head").remove(),c>0)for(var h=f;c>h;h++)d._addRow(d._filteredData[h],h);else d._addRow(!1)},BasicGrid.prototype._processData=function(a){var b=this;b._data=[];for(var c=0,d=a.length;d>c;c++){var e=a[c];b._data.push(e)}b._filteredData=b._data,b._items=b._filteredData.length},BasicGrid.prototype.filter=function(a){var b=this;if(a){var c,d,e,f,g=[];for(var h in a)c=h;var i=a[c].toLowerCase();for(b._searchableData||(b._searchableData=b._data),d=0,e=b._searchableData.length;e>d;d++)f=b._searchableData[d],-1!=f[c].toLowerCase().indexOf(i)&&g.push(f);b._filteredData=g,b._items=g.length}else b._filteredData=b._data,b._items=b._filteredData.length;b._populateGrid(),b._updatePagination()},BasicGrid.prototype.sort=function(a,b){var c=this,d=c._filteredData;d.sort(function(c,d){if("asc"===b){if(c[a].toLowerCase()>d[a].toLowerCase())return 1;if(c[a].toLowerCase()<d[a].toLowerCase())return-1}else{if(c[a].toLowerCase()<d[a].toLowerCase())return 1;if(c[a].toLowerCase()>d[a].toLowerCase())return-1}return 0}),c._filteredData=d,c._populateGrid(),c._updatePagination()},BasicGrid.prototype._init=function(){this._createTableHTML(),this._createPaginationHTML(),this._addEvents(),this._$grid=this.htmlElement.find("table"),this._$pagination=this.htmlElement.find(".BasicGrid-pagination"),this._$prev=this.htmlElement.find(".BasicGrid-prev"),this._$next=this.htmlElement.find(".BasicGrid-next"),this._processData(this.data),this._setupPagination(),this._populateGrid()};